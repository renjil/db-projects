-- ============================================
-- Loan Explorer - Table Setup Script
-- Run this in a Databricks SQL notebook or query editor
-- Catalog: renjiharold_demo | Schema: loan_explorer
-- ============================================

-- Step 1: Create schema if it doesn't exist
CREATE SCHEMA IF NOT EXISTS renjiharold_demo.loan_explorer;

-- Step 2: Create the loan_applications table
CREATE TABLE IF NOT EXISTS renjiharold_demo.loan_explorer.loan_applications (
    application_id STRING,
    applicant_name STRING,
    email STRING,
    phone STRING,
    loan_type STRING,
    loan_amount DECIMAL(12, 2),
    interest_rate DECIMAL(5, 2),
    loan_term_months INT,
    application_date DATE,
    status STRING,
    credit_score INT,
    annual_income DECIMAL(12, 2),
    employment_status STRING,
    employer_name STRING,
    property_address STRING,
    contract_path STRING,
    notes STRING,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

-- Step 3: Insert 10 sample loan applications
-- Step 3: Insert 10 sample loan applications
INSERT INTO renjiharold_demo.loan_explorer.loan_applications
  VALUES
    (
      'LOAN-2024-001',
      'Sarah Johnson',
      'sarah.johnson@email.com',
      '(555) 123-4567',
      'Mortgage',
      450000.00,
      6.75,
      360,
      '2024-11-15',
      'Approved',
      780,
      125000.00,
      'Employed',
      'Tech Solutions Inc.',
      '123 Oak Street, Austin, TX 78701',
      '/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-001_contract.pdf',
      'First-time homebuyer. Excellent credit history.',
      '2024-11-15 09:30:00',
      '2024-11-20 14:15:00'
    ),
    (
      'LOAN-2024-002',
      'Michael Chen',
      'michael.chen@email.com',
      '(555) 234-5678',
      'Auto',
      35000.00,
      5.25,
      60,
      '2024-11-18',
      'Approved',
      720,
      85000.00,
      'Employed',
      'City Hospital',
      NULL,
      '/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-002_contract.pdf',
      'New vehicle purchase - Honda Accord 2024.',
      '2024-11-18 11:00:00',
      '2024-11-22 10:30:00'
    ),
    (
      'LOAN-2024-003',
      'Emily Rodriguez',
      'emily.rodriguez@email.com',
      '(555) 345-6789',
      'Personal',
      15000.00,
      9.50,
      36,
      '2024-11-20',
      'Pending',
      680,
      62000.00,
      'Employed',
      'Marketing Masters LLC',
      NULL,
      "/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-003_contract.pdf",
      'Debt consolidation loan request.',
      '2024-11-20 14:45:00',
      '2024-11-20 14:45:00'
    ),
    (
      'LOAN-2024-004',
      'James Williams',
      'james.williams@email.com',
      '(555) 456-7890',
      'Mortgage',
      625000.00,
      6.50,
      360,
      '2024-11-22',
      'Under Review',
      750,
      175000.00,
      'Self-Employed',
      'Williams Consulting',
      '456 Maple Avenue, Denver, CO 80202',
      "/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-004_contract.pdf",
      'Investment property. Self-employed 5+ years.',
      '2024-11-22 16:20:00',
      '2024-11-25 09:00:00'
    ),
    (
      'LOAN-2024-005',
      'Amanda Foster',
      'amanda.foster@email.com',
      '(555) 567-8901',
      'Student',
      45000.00,
      4.99,
      120,
      '2024-11-25',
      'Approved',
      695,
      28000.00,
      'Part-Time',
      'University Bookstore',
      NULL,
      '/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-005_contract.pdf',
      'Graduate school tuition - MBA program.',
      '2024-11-25 10:15:00',
      '2024-11-28 11:30:00'
    ),
    (
      'LOAN-2024-006',
      'Robert Martinez',
      'robert.martinez@email.com',
      '(555) 678-9012',
      'Business',
      250000.00,
      7.25,
      84,
      '2024-11-28',
      'Pending',
      710,
      95000.00,
      'Self-Employed',
      'Martinez Auto Repair',
      '789 Industrial Blvd, Phoenix, AZ 85001',
      "/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-006_contract.pdf",
      'Business expansion - new location opening.',
      '2024-11-28 13:00:00',
      '2024-11-28 13:00:00'
    ),
    (
      'LOAN-2024-007',
      'Jennifer Lee',
      'jennifer.lee@email.com',
      '(555) 789-0123',
      'Home Equity',
      80000.00,
      7.00,
      180,
      '2024-12-01',
      'Approved',
      765,
      110000.00,
      'Employed',
      'State Government',
      '321 Pine Road, Seattle, WA 98101',
      '/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-007_contract.pdf',
      'Home renovation project - kitchen and bathroom.',
      '2024-12-01 09:45:00',
      '2024-12-05 15:20:00'
    ),
    (
      'LOAN-2024-008',
      'David Thompson',
      'david.thompson@email.com',
      '(555) 890-1234',
      'Auto',
      28000.00,
      6.00,
      48,
      '2024-12-03',
      'Rejected',
      580,
      45000.00,
      'Employed',
      'FastFood Corp',
      NULL,
      "/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-008_contract.pdf",
      'Credit score below minimum requirement.',
      '2024-12-03 11:30:00',
      '2024-12-04 16:00:00'
    ),
    (
      'LOAN-2024-009',
      'Lisa Anderson',
      'lisa.anderson@email.com',
      '(555) 901-2345',
      'Mortgage',
      380000.00,
      6.875,
      360,
      '2024-12-05',
      'Under Review',
      735,
      140000.00,
      'Employed',
      'Anderson Law Firm',
      '555 Court Street, Chicago, IL 60601',
      "/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-009_contract.pdf",
      'Primary residence purchase. Pre-approved.',
      '2024-12-05 14:00:00',
      '2024-12-08 10:45:00'
    ),
    (
      'LOAN-2024-010',
      'Christopher Brown',
      'chris.brown@email.com',
      '(555) 012-3456',
      'Personal',
      20000.00,
      8.75,
      24,
      '2024-12-10',
      'Approved',
      700,
      72000.00,
      'Employed',
      'National Bank',
      NULL,
      '/Volumes/renjiharold_demo/loan_explorer/loan_contracts/LOAN-2024-010_contract.pdf',
      'Medical expenses coverage.',
      '2024-12-10 08:30:00',
      '2024-12-12 12:00:00'
    )

-- Step 4: Verify the data
SELECT * FROM renjiharold_demo.loan_explorer.loan_applications;
